tls:
  certificates:
    - certFile: /ssl/cert.pem
      keyfile: /ssl/privkey.pem

http:
  middlewares:
    redirect-to-https:
      redirectScheme:
        scheme: https
        permanent: true

  routers:
    http-catch-all:
      rule: HostRegexp(`{any:.+}`)
      entrypoints:
        - web
      middlewares:
        - redirect-to-https
      service: noop@internal

    api:
      tls: true
      rule: "Host(`{{ ingress_dashboard_domain }}`)"
      entrypoints:
        - websecure
      service: api@internal

    metrics:
      tls: true
      rule: Host(`ingress-metrics.homecentr.io`) # TODO: This should be published on a different (internal) entrypoint
      entrypoints:
        - websecure
      service: prometheus@internal